import{_ as U}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-BU16DZwG.js";import{d as I,i as p,R as m,$ as E,r as n,o as _,c as z,a as g,b as o,w as l,F as j,f as P,e as u,u as v,z as W,W as K,T as O,aK as q,P as G,a0 as S,h as J}from"./index-MVVa4Kd4.js";import{b as Q,s as X,d as Z}from"./software-D2V1Z9AX.js";import ee from"./EditSoftware-DW0gxwBN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sortable.esm-C0-Qcoum.js";import"./index-Dv1ntQwP.js";import"./upload-ex8U0d6F.js";const te={class:"h-full"},ae={class:"card !pb-0 mb-2 flex"},oe={class:"flex"},le={class:"h-[calc(100%-72px)]"},me=I({__name:"index",setup(ne){const b="/",c=p(),V=p(),y=p(),w=p(0),k=p([]),f=p([]),s=m({pageSize:25,pageNum:1}),i=m({title:"",softwareTypeId:"",createdAt:["",""],updatedAt:["",""]}),$=m([{prop:"title",label:"软件名称"},{prop:"image",label:"封面图",render:({row:t})=>o(n("el-image"),{src:b+t.image,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[b+t.image],"initial-index":4,"preview-teleported":!0,"z-index":99999,fit:"cover",class:"h-20"},null)},{prop:"desc",label:"简介"},{prop:"updatedAt",label:"更新时间",width:180,sortable:!0,render:({row:t})=>t.updatedAt?S(t.updatedAt).format("YYYY-MM-DD HH:mm:ss"):""},{prop:"createdAt",label:"创建时间",width:180,sortable:!0,render:({row:t})=>S(t.createdAt).format("YYYY-MM-DD HH:mm:ss")},{prop:"operation",label:"操作",fixed:"right",width:120}]),Y=async()=>{const{data:t}=await Q();f.value=t},r=async(t=!1)=>{t&&(s.pageNum=1);const{data:e}=await X({...i,...s});k.value=e.softwares,w.value=e.total},A=t=>{t&&(t.resetFields(),r(!0))},B=t=>{q.confirm("此操作将永久删除该软件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await Z(t),G.success("删除成功"),r()})},D=()=>{var t;(t=c.value)==null||t.openDialog()};return E(()=>{r(),Y()}),(t,e)=>{const M=n("el-input"),x=n("el-form-item"),C=n("el-col"),N=n("el-option"),R=n("el-select"),h=n("el-row"),L=n("el-form"),d=n("el-button"),F=n("el-pagination");return _(),z("div",te,[g("div",ae,[o(L,{inline:!0,model:i,"label-width":"auto",ref_key:"searchFormRef",ref:y,class:"flex-1"},{default:l(()=>[o(h,{gutter:20},{default:l(()=>[o(C,{span:9},{default:l(()=>[o(x,{label:"软件名称",prop:"title"},{default:l(()=>[o(M,{modelValue:i.title,"onUpdate:modelValue":e[0]||(e[0]=a=>i.title=a),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),o(C,{span:9},{default:l(()=>[o(x,{label:"软件分类",prop:"softWareTypeId"},{default:l(()=>[o(R,{modelValue:i.softwareTypeId,"onUpdate:modelValue":e[1]||(e[1]=a=>i.softwareTypeId=a),placeholder:"请选择",clearable:""},{default:l(()=>[(_(!0),z(j,null,P(f.value,a=>(_(),J(N,{label:a.name,value:a.id,key:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),g("div",oe,[o(d,{type:"primary",icon:v(W),onClick:e[2]||(e[2]=a=>r(!0))},{default:l(()=>[u(" 搜索 ")]),_:1},8,["icon"]),o(d,{icon:v(K),onClick:e[3]||(e[3]=a=>A(y.value))},{default:l(()=>[u(" 重置 ")]),_:1},8,["icon"])])]),g("div",le,[o(U,{ref_key:"proTable",ref:V,"tool-button":!1,data:k.value,columns:$},{tableHeader:l(()=>[o(d,{type:"primary",icon:v(O),onClick:D},{default:l(()=>[u("新增软件")]),_:1},8,["icon"])]),operation:l(({row:a})=>[o(d,{type:"primary",link:"",onClick:H=>{var T;return(T=c.value)==null?void 0:T.openDialog(a)}},{default:l(()=>[u("编辑")]),_:2},1032,["onClick"]),o(d,{type:"danger",link:"",onClick:H=>B(a.id)},{default:l(()=>[u("删除")]),_:2},1032,["onClick"])]),pagination:l(()=>[o(F,{background:!0,"current-page":s.pageNum,"onUpdate:currentPage":e[4]||(e[4]=a=>s.pageNum=a),"page-size":s.pageSize,"onUpdate:pageSize":e[5]||(e[5]=a=>s.pageSize=a),"page-sizes":[10,25,50,100],total:w.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e[6]||(e[6]=a=>r()),onCurrentChange:e[7]||(e[7]=a=>r())},null,8,["current-page","page-size","total"])]),_:1},8,["data","columns"])]),o(ee,{ref_key:"editSoftwareRef",ref:c,"software-type-option":f.value,onRefreshList:e[8]||(e[8]=a=>r(!0))},null,8,["software-type-option"])])}}});export{me as default};
