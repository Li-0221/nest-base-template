import{a as h,m as w}from"./user-Bl9A1ko5.js";import{_ as P}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-BU16DZwG.js";import{d as T,i,R as _,$ as B,r,o as I,c as H,a as g,b as e,w as l,e as c,u as A,z as F,W as j,aK as K,P as O,a0 as C}from"./index-MVVa4Kd4.js";import{s as M}from"./userEnum-B75pT1mn.js";import{_ as W}from"./EditUser.vue_vue_type_script_setup_true_lang-WkOzmU3o.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sortable.esm-C0-Qcoum.js";const q={class:"h-full"},G={class:"card !pb-0 mb-2 flex"},J={class:"flex-col flex ml-8"},Q={class:"h-[calc(100%-122px)]"},re=T({__name:"index",setup(X){const b=i(),R=i(),v=i(),V=i(0),y=i([]),p=_({pageSize:25,pageNum:1}),n=_({name:"",phone:"",role:"",status:"",createdAt:["",""],lastLoginAt:["",""]}),D=_([{prop:"name",label:"用户昵称"},{prop:"phone",label:"电话"},{prop:"loginCount",label:"登录次数",sortable:!0},{prop:"status",label:"状态",render:({row:o})=>e(r("el-tag"),{type:M[o.status].type},{default:()=>[M[o.status].text]})},{prop:"role",label:"角色",render:({row:o})=>e(r("el-tag"),{type:o.role==="VIP_USER"?"primary":"info"},{default:()=>[o.role==="VIP_USER"?"VIP用户":"普通用户"]})},{prop:"createdAt",label:"创建时间",width:180,sortable:!0,render:({row:o})=>C(o.createdAt).format("YYYY-MM-DD HH:mm:ss")},{prop:"lastLoginAt",label:"登录时间",width:180,sortable:!0,render:({row:o})=>o.lastLoginAt?C(o.lastLoginAt).format("YYYY-MM-DD HH:mm:ss"):""},{prop:"operation",label:"操作",fixed:"right",width:120}]),s=async(o=!1)=>{o&&(p.pageNum=1);const{data:t}=await h({...n,...p});y.value=t.users,V.value=t.total},L=o=>{o&&(o.resetFields(),s(!0))},S=o=>{K.confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await w(o),O.success("删除成功"),s()})};return B(()=>{s()}),(o,t)=>{const x=r("el-input"),d=r("el-form-item"),u=r("el-col"),m=r("el-option"),U=r("el-select"),k=r("el-date-picker"),z=r("el-row"),$=r("el-form"),f=r("el-button"),E=r("el-pagination");return I(),H("div",q,[g("div",G,[e($,{inline:!0,model:n,"label-width":"auto",ref_key:"searchFormRef",ref:v,class:"flex-1"},{default:l(()=>[e(z,{gutter:20},{default:l(()=>[e(u,{span:8},{default:l(()=>[e(d,{label:"昵称",prop:"name"},{default:l(()=>[e(x,{modelValue:n.name,"onUpdate:modelValue":t[0]||(t[0]=a=>n.name=a),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(d,{label:"电话",prop:"phone"},{default:l(()=>[e(x,{modelValue:n.phone,"onUpdate:modelValue":t[1]||(t[1]=a=>n.phone=a),placeholder:"请输入",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(d,{label:"状态",prop:"status"},{default:l(()=>[e(U,{modelValue:n.status,"onUpdate:modelValue":t[2]||(t[2]=a=>n.status=a),placeholder:"请选择",clearable:""},{default:l(()=>[e(m,{label:"正常",value:"Normal"}),e(m,{label:"禁用",value:"Disabled"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(d,{label:"角色",prop:"role"},{default:l(()=>[e(U,{modelValue:n.role,"onUpdate:modelValue":t[3]||(t[3]=a=>n.role=a),placeholder:"请选择",clearable:""},{default:l(()=>[e(m,{label:"VIP用户",value:"VIP_USER"}),e(m,{label:"普通用户",value:"NORMAL_USER"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(d,{label:"创建时间",prop:"createdAt"},{default:l(()=>[e(k,{modelValue:n.createdAt,"onUpdate:modelValue":t[4]||(t[4]=a=>n.createdAt=a),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:l(()=>[e(d,{label:"登录时间",prop:"lastLoginAt"},{default:l(()=>[e(k,{modelValue:n.lastLoginAt,"onUpdate:modelValue":t[5]||(t[5]=a=>n.lastLoginAt=a),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),g("div",J,[e(f,{type:"primary",icon:A(F),onClick:t[6]||(t[6]=a=>s(!0))},{default:l(()=>[c(" 搜索 ")]),_:1},8,["icon"]),e(f,{icon:A(j),class:"!ml-0 mt-[18px]",onClick:t[7]||(t[7]=a=>L(v.value))},{default:l(()=>[c(" 重置 ")]),_:1},8,["icon"])])]),g("div",Q,[e(P,{ref_key:"proTable",ref:R,"tool-button":!1,data:y.value,columns:D},{operation:l(({row:a})=>[e(f,{type:"primary",link:"",onClick:N=>{var Y;return(Y=b.value)==null?void 0:Y.openDialog(a)}},{default:l(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),e(f,{type:"danger",link:"",onClick:N=>S(a.id)},{default:l(()=>[c("删除")]),_:2},1032,["onClick"])]),pagination:l(()=>[e(E,{background:!0,"current-page":p.pageNum,"onUpdate:currentPage":t[8]||(t[8]=a=>p.pageNum=a),"page-size":p.pageSize,"onUpdate:pageSize":t[9]||(t[9]=a=>p.pageSize=a),"page-sizes":[10,25,50,100],total:V.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:t[10]||(t[10]=a=>s()),onCurrentChange:t[11]||(t[11]=a=>s())},null,8,["current-page","page-size","total"])]),_:1},8,["data","columns"])]),e(W,{ref_key:"editUserRef",ref:b,onRefreshList:t[12]||(t[12]=a=>s())},null,512)])}}});export{re as default};
